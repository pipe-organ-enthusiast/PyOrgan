from typing import Final

# ======================================================================================================================
# Constants
# ======================================================================================================================
# ----------------------------------------------------------------------------------------------------------------------
# Organ Settings
# ----------------------------------------------------------------------------------------------------------------------
ORGAN_SETTINGS: Final = "Organ Settings"
NUMBER_DIVISIONS: Final = "Number of Divisions"
NUMBER_COUPLERS: Final = "Number of Couplers"
NUMBER_GENERALS: Final = "Number of Generals"
INCLUDE_CRESCENDO: Final = "Include Crescendo"
# ----------------------------------------------------------------------------------------------------------------------
# Stop Settings
# ----------------------------------------------------------------------------------------------------------------------
STOP_INFORMATION: Final = "Stop Information"
STOP_NAME: Final = "Stop Name"
STOP_FAMILY: Final = "Stop Family"
NUMBER_RANKS: Final = "Number of Ranks"
RANK_INFORMATION: Final = "Rank Information"
RANK_NUMBER: Final = "Rank Number"
RANK_SIZE: Final = "Rank Size"
NUMBER_PIPES: Final = "Number of Pipes"
STARTING_NOTE: Final = "Starting Note"
PIPE_INFORMATION: Final = "Pipe Information"
PIPE_CONSTRUCTION: Final = "Pipe Construction"
PIPE_TYPE: Final = "Pipe Type"
NUMBER_HARMONICS: Final = "Number of Harmonics"
PIPE_SETTINGS: Final = "Pipe Settings"
PIPE_NUMBER: Final = "Pipe Number"
ADSR_SETTINGS: Final = "ADSR Settings"
ATTACK_TIME: Final = "Attack Time"
DECAY_TIME: Final = "Decay Time"
SUSTAIN_LEVEL: Final = "Sustain Level"
RELEASE_TIME: Final = "Release Time"
AMPLITUDE: Final = "Amplitude"
HARMONIC_ADSR_SETTINGS: Final = "Harmonic ADSR Settings"
# ----------------------------------------------------------------------------------------------------------------------
# Audio Settings
# ----------------------------------------------------------------------------------------------------------------------
AUDIO_SETTINGS: Final = "Audio Settings"
AUDIO_DEVICE: Final = "Audio Device"
NUMBER_CHANNELS: Final = "Number of Channels"
BLOCK_SIZE: Final = "Block Size"
SAMPLERATE: Final = "Samplerate"
LATENCY: Final = "Latency"
# ----------------------------------------------------------------------------------------------------------------------
# Value Limits
# ----------------------------------------------------------------------------------------------------------------------
MINIMUM_DIVISIONS: Final = 1
MAXIMUM_DIVISIONS: Final = 8
MINIMUM_COUPLERS: Final = 0
MAXIMUM_COUPLERS: Final = 84
MINIMUM_GENERALS: Final = 0
MAXIMUM_GENERALS: Final = 10
MINIMUM_STOPS: Final = 1
MAXIMUM_STOPS: Final = 100
MINIMUM_DIVISIONAL_COUPLERS: Final = 0
MAXIMUM_DIVISIONAL_COUPLERS: Final = 3
MINIMUM_DIVISIONALS: Final = 0
MAXIMUM_DIVISIONALS: Final = 10
MINIMUM_RATE: Final = 0.0
MAXIMUM_RATE: Final = 20.0
MINIMUM_RANKS: Final = 1
MAXIMUM_RANKS: Final = 25  # Largest Mixture in existance has 25 Ranks
MINIMUM_HARMONICS: Final = 1
MAXIMUM_HARMONICS: Final = 20
MINIMUM_TIME: Final = 0.0
MAXIMUM_TIME: Final = 5.0
MINIMUM_AUDIO_LEVEL: Final = 0.0  # -  Use for Depth, Amplitude, Volume and Sustain Level limits
MAXIMUM_AUDIO_LEVEL: Final = 1.0  # /
MINIMUM_BEATS: Final = 0
MAXIMUM_BEATS: Final = 9
MINIMUM_BPM: Final = 30
MAXIMUM_BPM: Final = 250
MINIMUM_TRANSPOSER: Final = -7
MAXIMUM_TRANSPOSER: Final = 7
MINIMUM_CHANNELS: Final = 1
MAXIMUM_CHANNELS: Final = 8

# ======================================================================================================================
# Tuples
# ======================================================================================================================
DIVISION_NAMES: tuple[str, ...] = (
    "PEDAL",
    "GREAT",
    "SWELL",
    "CHOIR",
    "SOLO",
    "ECHO"
)
DIVISIONAL_COUPLER_TYPES: tuple[str, ...] = (
    "16'",
    "8'",
    "Unison Off"
)
STOP_FAMILIES: tuple[str, ...] = (
    "FOUNDATION",
    "FLUTE",
    "STRING",
    "REED",
    "PERCUSSION",
    "MUTATION",
    "MIXTURE"
)
RANK_SERIES_64: tuple[str, ...] = (
    "64'",
    "32'",
    "21 1/3'",
    "16'",
    "12 4/5'",
    "10 2/3'",
    "9 1/7'",
    "8'",
    "7 1/9'",
    "6 2/5'",
    "5 9/11'",
    "5 1/3'",
    "4 12/13'",
    "4 4/7'",
    "4 4/15'",
    "4'",
    "3 13/17'",
    "3 5/9'",
    "3 7/19'",
    "3 1/5'",
    "2 10/11'",
    "2 18/23'",
    "2 2/3'",
    "2 14/25'",
    "2 6/13'",
    "2 2/7'",
    "2 2/15'",
    "2'",
    "1 1/3'",
    "1'"
)
RANK_SERIES_32: tuple[str, ...] = (
    "32'",
    "16'",
    "10 2/3'",
    "8'",
    "6 2/5'",
    "5 1/3'",
    "4 4/7'",
    "4'",
    "3 5/9'",
    "3 1/5'",
    "2 10/11'",
    "2 2/3'",
    "2 6/13'",
    "2 2/7'",
    "2 2/15'",
    "2'",
    "1 15/17'",
    "1 7/9'",
    "1 13/19'",
    "1 3/5'",
    "1 5/11'",
    "1 9/23",
    "1 1/3'",
    "1 7/25'",
    "1 3/13'",
    "1 3/13'",
    "1 1/7'",
    "1 1/15'",
    "1'",
    "2/3'",
    "1/2'"
)
RANK_SERIES_16: tuple[str, ...] = (
    "16'",
    "8'",
    "5 1/3'",
    "4'",
    "3 1/5'",
    "2 2/3'",
    "2 2/7'",
    "2'",
    "1 7/9'",
    "1 3/5'",
    "1 5/11'",
    "1 1/3'",
    "1 3/13'",
    "1 1/7'",
    "1 1/15'",
    "1'",
    "16/17'",
    "8/9'",
    "16/19'",
    "4/5'",
    "8/11'",
    "16/23'",
    "2/3'",
    "16/25'",
    "2/3'",
    "16/25'",
    "8/13'",
    "4/7'",
    "8/15'",
    "1/2'",
    "1/3'",
    "1/4'"
)
RANK_SERIES_8: tuple[str, ...] = (
    "8'",
    "4'",
    "2 2/3'",
    "2'",
    "1 3/5'",
    "1 1/3'",
    "1 1/7'",
    "1'",
    "8/9'",
    "4/5'",
    "8/11'",
    "2/3'",
    "8/13'",
    "4/7'",
    "8/15'",
    "1/2'",
    "8/17'",
    "4/9'",
    "8/19'",
    "2/5'",
    "4/11'",
    "8/23'",
    "1/3'",
    "8/25'",
    "4/13'",
    "2/7'",
    "4/15'",
    "1/4'",
    "1/6'",
    "1/8'"
)
RANKS_SERIES_4: tuple[str, ...] = (
    "4'"
    "2'"
    "1 1/3'"
    "1'"
    "4/5'"
    "2/3'"
    "4/7'"
    "1/2'"
    "4/9'",
    "2/5'",
    "4/11'",
    "1/3'",
    "4/13'",
    "2/7'",
    "4/15'",
    "1/4'",
    "4/17'",
    "2/9'",
    "4/19'",
    "1/5'",
    "2/11'",
    "4/23'",
    "1/6'",
    "4/25'",
    "2/13'",
    "1/7'",
    "2/15'",
    "1/8'",
    "1/12'",
    "1/16"
)
NOTES: tuple[str, ...] = (
    "C0",
    "C#0",
    "D0",
    "D#0",
    "E0",
    "F0",
    "F#0",
    "G0",
    "G#0",
    "A0",
    "A#0",
    "B0",
    "C1",
    "C#1",
    "D1",
    "D#1",
    "E1",
    "F1",
    "F#1",
    "G1",
    "G#1",
    "A1",
    "A#1",
    "B1",
    "C2",
    "C#2",
    "D2",
    "D#2",
    "E2",
    "F2",
    "F#2",
    "G2",
    "G#2",
    "A2",
    "A#2",
    "B2",
    "C3",
    "C#3",
    "D3",
    "D#3",
    "E3",
    "F3",
    "F#3",
    "G3",
    "G#3",
    "A3",
    "A#3",
    "B3",
    "C4",
    "C#4",
    "D4",
    "D#4",
    "E4",
    "F4",
    "F#4",
    "G4",
    "G#4",
    "A4",
    "A#4",
    "B4",
    "C5"
)
NUMBER_PIPES_LIST: tuple[int, ...] = (
    13,
    25,
    27,
    30,
    32,
    49,
    56,
    58,
    61,
    73,
    76,
    85,
    88
)
PIPE_CONSTRUCTION_TYPES: tuple[str, ...] = (
    "OPEN",
    "CLOSED"
)
PIPE_TYPES: tuple[str, ...] = (
    "FLUE",
    "REED"
)
BLOCK_SIZES: tuple[int, ...] = (
    125,
    256,
    512,
    1024
)
SAMPLERATES: tuple[int, ...] = (
    44100,
    48000,
    96000
)
LATENCIES: tuple[str, ...] = (
    "low",
    "high"
)

# ======================================================================================================================
# Dictionaries
# ======================================================================================================================
PITCH_TO_MIDI: dict[str, int] = {
    "64'": -36,
    "32'": -24,
    "21 1/3'": -17,
    "16'": -12,
    "12 4/5'": -8,
    "10 2/3'": -5,
    "9 1/7'": -2,
    "8'": 0,
    "7 1/9'": 2,
    "6 2/5'": 4,
    "5 9/11'": 5,
    "5 1/3'": 7,
    "4 12/13'": 9,
    "4 4/7'": 10,
    "4 4/15'": 11,
    "4'": 12,
    "3 13/17'": 13,
    "3 5/9'": 14,
    "3 7/19'": 15,
    "3 1/5'": 16,
    "2 10/11'": 17,
    "2 18/23'": 18,
    "2 2/3'": 19,
    "2 14/25'": 20,
    "2 6/13'": 21,
    "2 2/7'": 22,
    "2 2/15'": 23,
    "2'": 24,
    "1 15/17'": 25,
    "1 7/9'": 26,
    "1 13/19'": 27,
    "1 3/5'": 28,
    "1 5/11'": 29,
    "1 9/23'": 30,
    "1 1/3'": 31,
    "1 7/25'": 32,
    "1 3/13'": 33,
    "1 1/7'": 34,
    "1 1/15'": 35,
    "1'": 36,
    "16/17'": 37,
    "8/9'": 38,
    "16/19'": 39,
    "4/5'": 40,
    "8/11'": 41,
    "16/23'": 42,
    "2/3'": 43,
    "16/25'": 44,
    "8/13'": 45,
    "4/7'": 46,
    "8/15'": 47,
    "1/2'": 48,
    "8/17'": 49,
    "4/9'": 50,
    "8/19'": 51,
    "2/5'": 52,
    "4/11'": 53,
    "8/23'": 54,
    "1/3'": 55,
    "8/25'": 56,
    "4/13'": 57,
    "2/7'": 58,
    "4/15'": 59,
    "1/4'": 60,
    "4/17'": 61,
    "2/9'": 62,
    "4/19'": 63,
    "1/5'": 64,
    "2/11'": 65,
    "4/23'": 66,
    "1/6'": 67,
    "4/25'": 68,
    "2/13'": 69,
    "1/7'": 70,
    "2/15'": 71,
    "1/8'": 72,
    "1/12'": 79,
    "1/16'": 84
}
PITCH_TO_NOTE: dict[str, str] = {
    "64'": "C(-1)",
    "32'": "C0",
    "21 1/3'": "G0",
    "16'": "C1",
    "12 4/5'": "E1",
    "10 2/3'": "G1",
    "9 1/7'": "Bb1",
    "8'": "C2",
    "7 1/9'": "D2",
    "6 2/5'": "E2",
    "5 9/11'": "F2",
    "5 1/3'": "G2",
    "4 12/13'": "A2",
    "4 4/7'": "Bb2",
    "4 4/15'": "B2",
    "4'": "C3",
    "3 13/17'": "Db3",
    "3 5/9'": "D3",
    "3 7/19'": "Eb3",
    "3 1/5'": "E3",
    "2 10/11'": "F3",
    "2 18/23'": "F#3",
    "2 2/3'": "G3",
    "2 14/25'": "G#3",
    "2 6/13'": "A3",
    "2 2/7'": "Bb3",
    "2 2/15'": "B3",
    "2'": "C4",
    "1 15/17'": "Db4",
    "1 7/9'": "D4",
    "1 13/19": "Eb4",
    "1 3/5'": "E4",
    "1 5/11'": "F4",
    "1 9/23'": "F#4",
    "1 1/3'": "G4",
    "1 7/25'": "G#4",
    "1 3/13'": "A4",
    "1 1/7'": "Bb4",
    "1 1/15'": "B4",
    "1'": "C5",
    "16/17'": "Db5",
    "8/9'": "D5",
    "16/19'": "Eb5",
    "4/5'": "E5",
    "8/11'": "F5",
    "16/23'": "F#5",
    "2/3'": "G5",
    "16/25'": "G#5",
    "8/13'": "A5",
    "4/7'": "Bb5",
    "8/15'": "B5",
    "1/2'": "C6",
    "8/17'": "Db6",
    "4/9'": "D6",
    "8/19'": "Eb6",
    "2/5'": "E6",
    "4/11'": "F6",
    "8/23'": "F#6",
    "1/3'": "G6",
    "8/25'": "G#6",
    "4/13'": "A6",
    "2/7'": "Bb6",
    "4/15'": "B6",
    "1/4'": "C7",
    "4/17'": "Db7",
    "2/9'": "D7",
    "4/19'": "Eb7",
    "1/5'": "E7",
    "2/11'": "F7",
    "4/23'": "F#7",
    "1/6'": "G7",
    "4/25'": "G#7",
    "2/13'": "A7",
    "1/7'": "Bb7",
    "2/15'": "B7",
    "1/8'": "C8",
    "1/12'": "G8",
    "1/16'": "C9"
}
NOTE_TO_MIDI: dict[str, int] = {
    "C2": 36,
    "C#2": 37,
    "D2": 38,
    "D#2": 39,
    "E2": 40,
    "F2": 41,
    "F#2": 42,
    "G2": 43,
    "G#2": 44,
    "A2": 45,
    "A#2": 46,
    "B2": 47,
    "C3": 48,
    "C#3": 49,
    "D3": 50,
    "D#3": 51,
    "E3": 52,
    "F3": 53,
    "F#3": 54,
    "G3": 55,
    "G#3": 56,
    "A3": 57,
    "A#3": 58,
    "B3": 59,
    "C4": 60,
    "C#4": 61,
    "D4": 62,
    "D#4": 63,
    "E4": 64,
    "F4": 65,
    "F#4": 66,
    "G4": 67,
    "G#4": 68,
    "A4": 69,
    "A#4": 70,
    "B4": 71,
    "C5": 72,
    "C#5": 73,
    "D5": 74,
    "D#5": 75,
    "E5": 76,
    "F5": 77,
    "F#5": 78,
    "G5": 79,
    "G#5": 80,
    "A5": 81,
    "A#5": 82,
    "B5": 83,
    "C6": 84,
    "C#6": 85,
    "D6": 86,
    "D#6": 87,
    "E6": 88,
    "F6": 89,
    "F#6": 90,
    "G6": 91,
    "G#6": 92,
    "A6": 93,
    "A#6": 94,
    "B6": 95,
    "C7": 96
}

# ======================================================================================================================
# Functions
# ======================================================================================================================
def midi_to_frequency(midi_number: int, frequency_A4: float) -> float:
    return frequency_A4 * pow(2, ((midi_number - 69)/12))
